<!--
 * @Author: wangyunbo
 * @Date: 2022-01-11 14:14:37
 * @LastEditors: wangyunbo
 * @LastEditTime: 2022-01-12 11:29:15
 * @FilePath: \dayByday\javascript\export.html
 * @Description: file content
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    #lineTd {
 background: #fff url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxsaW5lIHgxPSIwIiB5MT0iMCIgeDI9IjEwMCUiIHkyPSIxMDAlIiBzdHJva2U9ImJsYWNrIiBzdHJva2Utd2lkdGg9IjEiLz48L3N2Zz4=) no-repeat 100% center;   
}
  </style>
</head>
<body>
<a href="#" id="tests" onClick="javascript:fnExcelReport();">Download</a><br><br>

<table id="myTable">
  <tbody>
    <tr>
      <td id="lineTd" style="background: #fff url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxsaW5lIHgxPSIwIiB5MT0iMCIgeDI9IjEwMCUiIHkyPSIxMDAlIiBzdHJva2U9ImJsYWNrIiBzdHJva2Utd2lkdGg9IjEiLz48L3N2Zz4=) no-repeat 100% center;   ">
        <span style="float:left;margin-top:20px;">项目</span>
        <span style="float:right;margin-top:-10px;">日期</span>
      </td>
      <td>2010-10-15</td>
    </tr>
    <tr>
      <td>采购</td>
      <td>9000元</td>
    </tr>
  </tbody>

</table>
  <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
  <script>
    function fnExcelReport() {
      var tab_text = '<html xmlns:x="urn:schemas-microsoft-com:office:excel">';
      tab_text = tab_text + '<head><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet>';

      tab_text = tab_text + '<x:Name>Test Sheet</x:Name>';

      tab_text = tab_text + '<x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions></x:ExcelWorksheet>';
      tab_text = tab_text + '</x:ExcelWorksheets></x:ExcelWorkbook></xml></head><body>';

      tab_text = tab_text + "<table>";
      tab_text = tab_text + $('#myTable').html();
      tab_text = tab_text + '</table></body></html>';

      var data_type = 'data:application/vnd.ms-excel';

      var ua = window.navigator.userAgent;
      var msie = ua.indexOf("MSIE ");

      if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) {
        if (window.navigator.msSaveBlob) {
          var blob = new Blob([tab_text], {
            type: "application/csv;charset=utf-8;"
          });
          navigator.msSaveBlob(blob, 'Test file.xls');
        }
      } else {
        $('#tests').attr('href', data_type + ', ' + encodeURIComponent(tab_text));
        $('#tests').attr('download', 'Test file.xls');
      }
    }

  </script>
</body>
</html>